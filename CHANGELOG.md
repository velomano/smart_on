# 📋 Changelog

모든 주요 변경사항과 기능 개선을 기록합니다.

## [2025.10.01 PM] - 멀티 테넌트 시스템 및 생육 단계 관리 기능 추가

### 🏢 멀티 테넌트 SaaS 시스템
- **서브도메인 기반 테넌트 식별**: Next.js middleware로 자동 처리
- **완벽한 데이터 격리**: RLS 정책으로 테넌트별 데이터 완전 분리
- **공용 서비스 구분**: 배양액 레시피, 시세 등 공유 데이터
- **Vercel 멀티 도메인 준비**: Wildcard 도메인 지원

### 🌱 생육 단계 관리 시스템
- **프로그레스 바 시각화**: 베드 SVG 내부에 생육 단계 게이지 표시
- **사용자 맞춤형 설정**: 슬라이더로 단계별 기간 직접 조절
- **파종/육묘 구분**: 4단계(발아/생식/영양/수확) vs 3단계
- **실시간 진행률**: 경과일/총일수, 현재 단계 자동 계산
- **날짜 기반 계산**: 각 단계 전환 날짜 자동 표시

### 🔧 관리 기능 개선
- **시스템 관리자 승인**: 조 배정 없이 승인 가능
- **작물 정보 관리**: 정식일자, 수확일자, 생육 단계 설정
- **모달창 UX**: 스크롤 개선, 반응형 디자인

### 🐛 버그 수정
- **TypeScript 타입 에러**: Next.js 15 params Promise 타입 대응
- **SVG 속성 에러**: rx 속성 수정
- **API 인증 문제**: Vercel 도메인 허용 목록 추가
- **Controlled input 경고**: harvestDate 기본값 처리

## [2025.10.01 AM] - 레시피 상세 정보 시스템 대폭 개선

### 🚀 새로운 기능
- **완전한 레시피 상세 정보**: 7개 섹션으로 구성된 포괄적 레시피 정보 시스템
- **실시간 레시피 업데이트**: 오늘 추가된 레시피 실시간 표시 및 상세 보기
- **레시피 출처 정보**: FAO Open Knowledge, 농촌진흥청 등 정확한 출처 표시

### 📋 레시피 상세 정보 섹션
- **기본 정보**: 작물, 성장 단계, 용량, NPK 비율
- **레시피 설명**: 상세한 레시피 설명 및 개요
- **재배 환경 조건**: 온도, 습도, 조명 시간, CO₂ 농도
- **영양소 상세 정보**: 질소, 인산, 칼륨, 칼슘, 마그네슘, 미량원소
- **사용법**: 레시피 사용 방법 및 권장사항
- **주의사항**: 중요한 주의사항 및 경고사항
- **출처 및 메타 정보**: 출처, 작성자, 라이선스, 업데이트 날짜

### 🔧 개선사항
- **데이터 매핑 수정**: API 응답에서 모든 필드 올바르게 매핑
- **UI/UX 개선**: 섹션별 색상 구분, 이모지 아이콘, 구조화된 레이아웃
- **일관성 확보**: 레시피 브라우징과 동일한 정보 구조 적용
- **모바일 최적화**: 반응형 디자인으로 모바일 환경 최적화

### 🐛 버그 수정
- **데이터 누락 문제**: description, growing_conditions, nutrients_detail 등 필드 누락 해결
- **정보 불일치**: 레시피 브라우징과 상세 정보 모달창 정보 일치
- **출처 정보 오류**: "스마트팜 데이터베이스" 표시 문제 해결

### 🗄️ 데이터베이스 변경
- **crop_profiles 테이블 확장**: 9개 컬럼 추가 (source_title, description, growing_conditions 등)
- **기존 데이터 업데이트**: FAO Open Knowledge, 농촌진흥청 출처 정보 설정
- **데이터 무결성**: 모든 레시피에 완전한 메타데이터 제공

### 📱 사용자 인터페이스
- **모달창 디자인**: 반투명 배경, 섹션별 색상 구분
- **정보 표시**: 조건부 렌더링으로 데이터 유무에 따른 섹션 표시
- **사용자 경험**: 불필요한 "전체 레시피 보기" 버튼 제거

## [2025.01.24] - 실시간 알림 시스템 및 베드 경고 기능 추가

### 🚨 새로운 기능
- **실시간 알림 시스템**: 텔레그램 + 대시보드 동시 알림 지원
- **베드별 경고 시스템**: 센서 데이터 이상 시 해당 베드 카드 자동 깜빡임
- **센서 임계값 모니터링**: 온도, 습도, pH 등 센서 데이터 실시간 감지
- **중복 알림 방지**: 동일 알림 간격 설정으로 알림 스팸 방지

### 🔧 개선사항
- **텔레그램 알림 최적화**: 유효한 채팅 ID 검증 및 에러 처리 개선
- **베드 상태 표시**: 온라인/오프라인 상태 표시 제거로 UI 간소화
- **전역 알림 배지**: 모든 페이지에서 알림 배지 표시 가능
- **Mock 센서 데이터**: 테스트용 센서 데이터 조작 기능 강화

### 🐛 버그 수정
- **Device ID 매핑**: `device-3` → `bed_003` 변환 로직 추가
- **텔레그램 API 에러**: 유효하지 않은 채팅 ID로 인한 전송 실패 해결
- **베드 깜빡임**: 여러 베드가 동시에 깜빡이는 문제 해결
- **경고 효과 강화**: 희미한 깜빡임 효과를 더 명확한 시각적 경고로 개선

### 📱 사용자 인터페이스
- **베드 카드 디자인**: 테두리 깜빡임, 그림자 효과로 강화된 시각적 경고
- **알림 배지 기능**: 경고 레벨별 색상 및 시각적 구분 개선
- **테스트 버튼**: 알림 설정 페이지 센서 테스트 기능 통합

### 🔐 보안 및 인증
- **세션 관리**: AuthSessionManager 시스템 도입 (무한로딩 문제로 제거됨)
- **Mock 인증**: 기존 Mock 인증 시스템 안정성 확보
- **Revert 인증**: 복잡한 인증 로직에서 안정적 Mock 인증으로 복구

### 🧪 테스트 및 디버깅
- **실시간 디버깅**: 센서 데이터 임계값 체크 로그 추가
- **테스트 좐샆뽀**: 2농장 1베드 특정 베드 테스트 모드 구현
- **IDE 에러 해결**: 빌드 에러 및 무한로딩 문제 완전 해결

---

## [이전 버전]

이전 버전의 세부사항은 Git 히스토리에서 확인 가능합니다.
