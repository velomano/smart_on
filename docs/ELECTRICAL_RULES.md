# 전기적 설계 규칙

## 공통 접지 (GND)
- **모든 장치의 GND는 반드시 공통으로 연결**
- ESP32, 센서, 액추에이터, 외부 전원의 GND를 하나로 통합
- 노이즈 방지를 위한 단일 접지점 사용

## 전원 분리
- **ESP32**: 3.3V (내장 레귤레이터 또는 외부 3.3V 공급)
- **센서**: 3.3V 또는 5V (데이터시트 확인)
- **액추에이터**: 외부 전원 (5V/12V/24V)
  - 릴레이: 5V 또는 12V
  - SSR: 3-32V DC
  - DC 모터: 12V/24V
  - 솔레노이드: 12V/24V

## 신호 레벨
- **ESP32 출력**: 3.3V (최대 40mA)
- **액추에이터 제어**: 외부 드라이버 모듈 사용
  - MOSFET 드라이버 모듈 권장
  - 릴레이 모듈 (광절연)
  - SSR (Solid State Relay)

## I2C 전기 규칙
- **풀업 저항**: 3.3V 기준 4.7kΩ
- **5V 풀업 모듈 금지** (ESP32 3.3V 호환성)
- 필요시 점퍼/저항 교체하여 3.3V 풀업으로 변경
- 최대 케이블 길이: 1m 이하 권장

## 액추에이터 보호 회로
### DC 모터/솔레노이드
- **MOSFET 드라이버 모듈 사용**
- **플라이백 다이오드** (드라이버 모듈에 내장됨)
- 과전류 보호 회로

### 릴레이/SSR
- **광절연 모듈 권장**
- IN 핀 논리 레벨 확인
  - `activeLow`: LOW일 때 동작
  - `activeHigh`: HIGH일 때 동작
- 릴레이 코일 과전압 보호

## 노이즈 방지
- **디지털/아날로그 전원 분리**
- **배선 길이 최소화**
- **트위스트 페어 케이블 사용** (장거리)
- **차폐 케이블** (고감도 센서용)

## 안전 규칙
1. **전원 분리 상태에서 배선 확인**
2. **외부 전원 극성 확인**
3. **모듈 IN 논리 레벨 확인**
4. **과전류/과전압 보호 회로 설치**
5. **접지 누설 전류 확인**

## 테스트 순서
1. 센서만 연결 → I2C 주소 확인
2. 액추에이터 보드 IN만 연결 → GPIO 토글 테스트
3. 외부 전원 연결 → Self-Test 실행
4. 재부팅 테스트 → 릴레이 딸깍 없음 확인
